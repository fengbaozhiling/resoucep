function doane(a){e=a?a:window.event,is_ie?(e.returnValue=!1,e.cancelBubble=!0):e&&(e.stopPropagation(),e.preventDefault())}function getposition(a){var b=new Array;for(b.x=a.offsetLeft,b.y=a.offsetTop;a=a.offsetParent;)b.x+=a.offsetLeft,b.y+=a.offsetTop;return b}function loadcalendar(){var b,c,d,e,a="";for(a+='<div id="calendar" style="display:none; position:absolute; z-index:100000;" onclick="doane(event)">',a+='<div style="width: 210px;"><table cellspacing="0" cellpadding="0" width="100%" style="text-align: center;">',a+='<tr align="center" id="calendar_week" ><td><a href="###" onclick="refreshcalendar(yy, mm-1)" title="上一月"><<</a></td><td colspan="5" style="text-align: center"><a href="###" onclick="showdiv(\'year\');doane(event)" class="dropmenu" title="点击选择年份" id="year"></a>&nbsp; - &nbsp;<a id="month" class="dropmenu" title="点击选择月份" href="###" onclick="showdiv(\'month\');doane(event)"></a></td><td><A href="###" onclick="refreshcalendar(yy, mm+1)" title="下一月">>></A></td></tr>',a+='<tr id="calendar_header"><td>日</td><td>一</td><td>二</td><td>三</td><td>四</td><td>五</td><td>六</td></tr>',b=0;6>b;b++){for(a+="<tr>",c=1;7>=c;c++)a+="<td id=d"+(7*b+c)+' height="19">0</td>';a+="</tr>"}for(a+='<tr id="hourminute"><td colspan="7" align="center"><input type="text" size="2" value="" id="hour" class="txt" onKeyUp=\'this.value=this.value > 23 ? 23 : zerofill(this.value);controlid.value=controlid.value.replace(/\\d+(:\\d+)/ig, this.value+"$1")\'> 点 <input type="text" size="2" value="" id="minute" class="txt" onKeyUp=\'this.value=this.value > 59 ? 59 : zerofill(this.value);controlid.value=controlid.value.replace(/(\\d+:)\\d+/ig, "$1"+this.value)\'> 分</td></tr>',a+="</table></div></div>",a+='<div id="calendar_year" onclick="doane(event)" style="display: none;z-index:100001;"><div class="col">',d=2020;d>=1931;d--)a+=2020!=d&&0==d%10?'</div><div class="col">':"",a+='<a href="###" onclick="refreshcalendar('+d+", mm);document.getElementById('calendar_year').style.display='none'\"><span"+(today.getFullYear()==d?' class="calendar_today"':"")+' id="calendar_year_'+d+'">'+d+"</span></a><br />";for(a+="</div></div>",a+='<div id="calendar_month" onclick="doane(event)" style="display: none;z-index:100001;">',d=1;12>=d;d++)a+='<a href="###" onclick="refreshcalendar(yy, '+(d-1)+");document.getElementById('calendar_month').style.display='none'\"><span"+(today.getMonth()+1==d?' class="calendar_today"':"")+' id="calendar_month_'+d+'">'+d+(10>d?"&nbsp;":"")+" 月</span></a><br />";a+="</div>",is_ie&&7>is_ie&&(a+='<iframe id="calendariframe" frameborder="0" style="display:none;position:absolute;filter:progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0)"></iframe>',a+='<iframe id="calendariframe_year" frameborder="0" style="display:none;position:absolute;filter:progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0)"></iframe>',a+='<iframe id="calendariframe_month" frameborder="0" style="display:none;position:absolute;filter:progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0)"></iframe>'),e=document.createElement("div"),e.innerHTML=a,document.getElementById("append_parent").appendChild(e),document.onclick=function(){document.getElementById("calendar").style.display="none",document.getElementById("calendar_year").style.display="none",document.getElementById("calendar_month").style.display="none",is_ie&&7>is_ie&&(document.getElementById("calendariframe").style.display="none",document.getElementById("calendariframe_year").style.display="none",document.getElementById("calendariframe_month").style.display="none")},document.getElementById("calendar").onclick=function(a){doane(a),document.getElementById("calendar_year").style.display="none",document.getElementById("calendar_month").style.display="none",is_ie&&7>is_ie&&(document.getElementById("calendariframe_year").style.display="none",document.getElementById("calendariframe_month").style.display="none")}}function parsedate(a){var b,c,d,e,f;return/(\d+)\-(\d+)\-(\d+)\s*(\d*):?(\d*)/.exec(a),b=RegExp.$1&&RegExp.$1>1899&&RegExp.$1<2101?parseFloat(RegExp.$1):today.getFullYear(),c=RegExp.$2&&RegExp.$2>0&&RegExp.$2<13?parseFloat(RegExp.$2):today.getMonth()+1,d=RegExp.$3&&RegExp.$3>0&&RegExp.$3<32?parseFloat(RegExp.$3):today.getDate(),e=RegExp.$4&&RegExp.$4>-1&&RegExp.$4<24?parseFloat(RegExp.$4):0,f=RegExp.$5&&RegExp.$5>-1&&RegExp.$5<60?parseFloat(RegExp.$5):0,/(\d+)\-(\d+)\-(\d+)\s*(\d*):?(\d*)/.exec("0000-00-00 00:00"),new Date(b,c-1,d,e,f)}function settime(a){document.getElementById("calendar").style.display="none",document.getElementById("calendar_month").style.display="none",is_ie&&7>is_ie&&(document.getElementById("calendariframe").style.display="none"),controlid.value=yy+"-"+zerofill(mm+1)+"-"+zerofill(a)+(addtime?" "+zerofill(document.getElementById("hour").value)+":"+zerofill(document.getElementById("minute").value):""),controlid.focus(),controlid.blur(),$(controlid).change()}function showcalendar(a,b,c,d,e){controlid=b,addtime=c,startdate=d?parsedate(d):!1,enddate=e?parsedate(e):!1,currday=controlid.value?parsedate(controlid.value):today,hh=currday.getHours(),ii=currday.getMinutes();var f=getposition(controlid);document.getElementById("calendar").style.display="block",document.getElementById("calendar").style.left=f.x+"px",document.getElementById("calendar").style.top=f.y+20+"px",doane(a),refreshcalendar(currday.getFullYear(),currday.getMonth()),0!=lastcheckedyear&&(document.getElementById("calendar_year_"+lastcheckedyear).className="calendar_default",document.getElementById("calendar_year_"+today.getFullYear()).className="calendar_today"),0!=lastcheckedmonth&&(document.getElementById("calendar_month_"+lastcheckedmonth).className="calendar_default",document.getElementById("calendar_month_"+(today.getMonth()+1)).className="calendar_today"),document.getElementById("calendar_year_"+currday.getFullYear()).className="calendar_checked",document.getElementById("calendar_month_"+(currday.getMonth()+1)).className="calendar_checked",document.getElementById("hourminute").style.display=addtime?"":"none",lastcheckedyear=currday.getFullYear(),lastcheckedmonth=currday.getMonth()+1,is_ie&&7>is_ie&&(document.getElementById("calendariframe").style.top=document.getElementById("calendar").style.top,document.getElementById("calendariframe").style.left=document.getElementById("calendar").style.left,document.getElementById("calendariframe").style.width=document.getElementById("calendar").offsetWidth,document.getElementById("calendariframe").style.height=document.getElementById("calendar").offsetHeight,document.getElementById("calendariframe").style.display="block")}function refreshcalendar(a,b){var g,c=new Date(a,b,1),d=c.getDay(),e=c.getDate(),f=null;for(yy=c.getFullYear(),mm=c.getMonth(),document.getElementById("year").innerHTML=yy,document.getElementById("month").innerHTML=mm+1>9?mm+1:"0"+(mm+1),g=1;d>=g;g++)f=document.getElementById("d"+g),f.innerHTML="&nbsp;",f.className="";for(;c.getMonth()==mm;)f=document.getElementById("d"+(e+d)),f.innerHTML='<a href="###" onclick="settime('+e+');return false">'+e+"</a>",f.className=enddate&&c.getTime()>enddate.getTime()||startdate&&c.getTime()<startdate.getTime()?"calendar_expire":"calendar_default",c.getFullYear()==today.getFullYear()&&c.getMonth()==today.getMonth()&&c.getDate()==today.getDate()&&(f.className="calendar_today",f.firstChild.title="今天"),c.getFullYear()==currday.getFullYear()&&c.getMonth()==currday.getMonth()&&c.getDate()==currday.getDate()&&(f.className="calendar_checked"),c.setDate(++e);for(;42>=e+d;)f=document.getElementById("d"+(e+d)),f.innerHTML="&nbsp;",e++;addtime&&(document.getElementById("hour").value=zerofill(hh),document.getElementById("minute").value=zerofill(ii))}function showdiv(a){var b=getposition(document.getElementById(a));document.getElementById("calendar_"+a).style.left=b.x+"px",document.getElementById("calendar_"+a).style.top=b.y+16+"px",document.getElementById("calendar_"+a).style.display="block",is_ie&&7>is_ie&&(document.getElementById("calendariframe_"+a).style.top=document.getElementById("calendar_"+a).style.top,document.getElementById("calendariframe_"+a).style.left=document.getElementById("calendar_"+a).style.left,document.getElementById("calendariframe_"+a).style.width=document.getElementById("calendar_"+a).offsetWidth,document.getElementById("calendariframe_"+a).style.height=document.getElementById("calendar_"+a).offsetHeight,document.getElementById("calendariframe_"+a).style.display="block")}function zerofill(a){var a=parseFloat(a.toString().replace(/(^[\s0]+)|(\s+$)/g,""));return a=isNaN(a)?0:a,(10>a?"0":"")+a.toString()}var userAgent=navigator.userAgent.toLowerCase(),is_opera=-1!=userAgent.indexOf("opera")&&opera.version(),is_moz="Gecko"==navigator.product&&userAgent.substr(userAgent.indexOf("firefox")+8,3),is_ie=-1!=userAgent.indexOf("msie")&&!is_opera&&userAgent.substr(userAgent.indexOf("msie")+5,3),is_safari=-1!=userAgent.indexOf("webkit")||-1!=userAgent.indexOf("safari"),controlid=null,currdate=null,startdate=null,enddate=null,yy=null,mm=null,hh=null,ii=null,currday=null,addtime=!1,today=new Date,lastcheckedyear=!1,lastcheckedmonth=!1;loadcalendar();