<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>ajax上传控件</title>
<script src="http://static10.epweike.cn/js/jquery.js"></script>
<script src="ajaxfileupload.js"></script>
</head>

<body>
<input id="fileToUpload" type="file" size="20" name="fileToUpload" class="input">
<button id="buttonUpload">上传</button>
<img id="loading" src="loading-small.gif" style="display:none;">

<script language="javascript">
jQuery(function(){   
  $("#buttonUpload").click(function(){     
	 $("#loading").ajaxStart(function(){
		$(this).show();
	 }).ajaxComplete(function(){
		$(this).hide();
	 });
	  //上传文件
	$.ajaxFileUpload({
		url:'upload.php',//处理图片脚本
		secureuri :false,
		fileElementId :'fileToUpload',//file控件id
		dataType : 'json',
		success : function (data, status){
			if(typeof(data.error) != 'undefined'){
				if(data.error != ''){
					alert(data.error);
				}else{
					alert(data.msg);
				}
			}
		},
		error: function(data, status, e){
			alert(e);
		}
})
return false;
  }) 
})
</script>
</body>
</html>
